

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The rampart-crypto module &mdash; Rampart 0.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="_static/hacks.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="Rampart 0.1.0 documentation" href="index.html"/>
        <link rel="next" title="The rampart-curl module" href="rampart-curl.html"/>
        <link rel="prev" title="The rampart-server HTML module" href="rampart-html.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> Rampart
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="rampart-main.html">Rampart JavaScript</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-utils.html">Rampart Utility Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="sqltoc.html">The rampart-sql module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-server.html">The rampart-server module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-html.html">The rampart-html module</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The rampart-crypto module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#preface">Preface</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#acknowledgment">Acknowledgment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#license">License</a></li>
<li class="toctree-l3"><a class="reference internal" href="#what-does-it-do">What does it do?</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-does-it-work">How does it work?</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#loading-and-using-the-module">Loading and Using the Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#loading">Loading</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#encryption-and-decryption">Encryption and Decryption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#encrypt">encrypt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#decrypt">decrypt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#passtokeyiv">passToKeyIv</a></li>
<li class="toctree-l3"><a class="reference internal" href="#supported-modes">Supported Modes</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#rsa-encryption">RSA Encryption</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rsa-gen-key">rsa_gen_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa-import-priv-key">rsa_import_priv_key</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa-components">rsa_components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa-pub-encrypt">rsa_pub_encrypt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa-priv-decrypt">rsa_priv_decrypt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa-sign">rsa_sign</a></li>
<li class="toctree-l3"><a class="reference internal" href="#rsa-verify">rsa_verify</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gen-csr">gen_csr</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#hashing">Hashing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#hash">hash</a></li>
<li class="toctree-l3"><a class="reference internal" href="#alias-functions">alias functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hmac">hmac</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#random">Random</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rand">rand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#randnum">randnum</a></li>
<li class="toctree-l3"><a class="reference internal" href="#gaussrand">gaussrand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normrand">normrand</a></li>
<li class="toctree-l3"><a class="reference internal" href="#seed">seed</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#bigint">BigInt</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#jsbi-bigint">JSBI.BigInt</a></li>
<li class="toctree-l3"><a class="reference internal" href="#jsbi-compatible-functions">JSBI Compatible functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tosignedstring">toSignedString</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="rampart-curl.html">The rampart-curl module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-lmdb.html">The rampart-lmdb module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-redis.html">The rampart-redis module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-robots.html">The rampart-robots module</a></li>
<li class="toctree-l1"><a class="reference internal" href="rampart-cmark.html">The rampart-cmark module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Rampart</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The rampart-crypto module</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/rampart-crypto.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="the-rampart-crypto-module">
<h1>The rampart-crypto module<a class="headerlink" href="#the-rampart-crypto-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="preface">
<h2>Preface<a class="headerlink" href="#preface" title="Permalink to this headline">¶</a></h2>
<div class="section" id="acknowledgment">
<h3>Acknowledgment<a class="headerlink" href="#acknowledgment" title="Permalink to this headline">¶</a></h3>
<p>The rampart-crypto module uses the <a class="reference external" href="https://www.openssl.org/">OpenSSL</a>
library.  We extend our thanks to the developers for this indispensable
tool.</p>
</div>
<div class="section" id="license">
<h3>License<a class="headerlink" href="#license" title="Permalink to this headline">¶</a></h3>
<p>The rampart-crypto module is released under the MIT license.
The <a class="reference external" href="https://www.openssl.org/">OpenSSL</a> library is released under the
<a class="reference external" href="https://github.com/openssl/openssl/blob/master/LICENSE.txt">Apache 2.0 License</a>.</p>
</div>
<div class="section" id="what-does-it-do">
<h3>What does it do?<a class="headerlink" href="#what-does-it-do" title="Permalink to this headline">¶</a></h3>
<p>The rampart-crypto module provides methods to encrypt, decrypt, hash and
generate HMACs from within Rampart JavaScript.
It also includes the full libssl and libcrypto libraries and is needed for
the rampart-curl and rampart-server modules to operate using the https
protocol.</p>
</div>
<div class="section" id="how-does-it-work">
<h3>How does it work?<a class="headerlink" href="#how-does-it-work" title="Permalink to this headline">¶</a></h3>
<p>After the module is loaded, functions are provided to perform crypto
operations on JavaScript <span class="green">Strings</span> or <span class="green">Buffers</span>.</p>
</div>
</div>
<div class="section" id="loading-and-using-the-module">
<h2>Loading and Using the Module<a class="headerlink" href="#loading-and-using-the-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="loading">
<h3>Loading<a class="headerlink" href="#loading" title="Permalink to this headline">¶</a></h3>
<p>Loading the module is a simple matter of using the <code class="docutils literal notranslate"><span class="pre">require()</span></code> function:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="encryption-and-decryption">
<h2>Encryption and Decryption<a class="headerlink" href="#encryption-and-decryption" title="Permalink to this headline">¶</a></h2>
<div class="section" id="encrypt">
<h3>encrypt<a class="headerlink" href="#encrypt" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">encrypt()</span></code> function encrypts the contents of a <span class="green">String</span> or
<span class="green">Buffer</span>.  Encryption can be done by providing a key/iv pair or by
providing a password.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>

<span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="nx">pass</span><span class="p">,</span> <span class="nx">data</span><span class="p">[,</span> <span class="nx">cipher_mode</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pass</span></code> is a password used to encrypt the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span>, the data to be
encrypted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cipher_mode</span></code> is one of the <a class="reference internal" href="#supported-modes">Supported Modes</a> listed below.  If not specified,
the default is <code class="docutils literal notranslate"><span class="pre">aes-256-cbc</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code> is an <span class="green">Object</span> which may contain the following:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> - same as <code class="docutils literal notranslate"><span class="pre">data</span></code> above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cipher</span></code> - same as <code class="docutils literal notranslate"><span class="pre">cipher_mode</span></code> above.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pass</span></code> - a password used to generate a key/iv pair and encrypt the
data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">key</span></code> - required if not using a password - a key of the appropriate length for
the chosen cipher. <code class="docutils literal notranslate"><span class="pre">key</span></code> can be a <span class="green">Buffer</span> or a hex encoded <span class="green">String</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iv</span></code> - required if not using a password - an initialization vector of
the appropriate length to be used for encrypting the data. <code class="docutils literal notranslate"><span class="pre">iv</span></code> can be
a <span class="green">Buffer</span> or a hex encoded <span class="green">String</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iter</span></code> - number of iterations for generating a key and iv from <code class="docutils literal notranslate"><span class="pre">pass</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">10000</span></code>.  If provided, the same value must be passed to
<a class="reference internal" href="#decrypt">decrypt</a> below in order to decrypt the ciphertext.</p></li>
</ul>
</li>
</ul>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">Buffer</span> containing the ciphertext (encrypted data).
Using <code class="docutils literal notranslate"><span class="pre">crypto.encrypt(&quot;password&quot;,</span> <span class="pre">data)</span></code> produces the same results as
<code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">enc</span> <span class="pre">-aes-256-cbc</span> <span class="pre">-e</span> <span class="pre">-pbkdf2</span>&#160; <span class="pre">-pass</span> <span class="pre">pass:&quot;password&quot;</span> <span class="pre">-in</span> <span class="pre">myfile.txt</span></code>
using openssl version 1.1.1 from the command line.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="s2">&quot;mypass&quot;</span><span class="p">,</span> <span class="s2">&quot;my data&quot;</span><span class="p">,</span> <span class="s2">&quot;aes-128-cbc&quot;</span><span class="p">);</span>
</pre></div>
</div>
<dl class="simple">
<dt>Caveat:</dt><dd><p>The choice of <code class="docutils literal notranslate"><span class="pre">10000</span></code> iterations is the default used by both the command line
<code class="docutils literal notranslate"><span class="pre">openssl</span></code> tool and rampart-crypto. It is purposefully slow, in order to make
dictionary attacks on the password difficult.  If computational speed is a
factor (e.g. in a HTTP server context), choosing a password of random characters
and significantly lowering the <code class="docutils literal notranslate"><span class="pre">iter</span></code> value (or using the <code class="docutils literal notranslate"><span class="pre">key</span></code> and <code class="docutils literal notranslate"><span class="pre">iv</span></code>
options instead of a password) will be more performant.</p>
</dd>
</dl>
</div>
<div class="section" id="decrypt">
<h3>decrypt<a class="headerlink" href="#decrypt" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">decrypt()</span></code> function takes the same arguments as <a class="reference internal" href="#encrypt">encrypt</a> above, but decrypts
the data.</p>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">Buffer</span> containing the decrypted text.
Calling <code class="docutils literal notranslate"><span class="pre">crypto.decrypt(&quot;password&quot;,</span> <span class="pre">data)</span></code> produces the same results
as <code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">enc</span> <span class="pre">-aes-256-cbc</span> <span class="pre">-d</span> <span class="pre">-pbkdf2</span>&#160; <span class="pre">-pass</span> <span class="pre">pass:&quot;password&quot;</span> <span class="pre">-in</span> <span class="pre">myfile.enc</span></code>
using openssl version 1.1.1 from the command line.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">({</span>
    <span class="nx">pass</span><span class="o">:</span> <span class="s2">&quot;mypass&quot;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="s2">&quot;my data&quot;</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">plaintext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">({</span>
    <span class="nx">pass</span><span class="o">:</span> <span class="s2">&quot;mypass&quot;</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="nx">ciphertext</span>
<span class="p">});</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s1">&#39;The decrypted data: &quot;%s&quot;\n&#39;</span><span class="p">,</span> <span class="nx">plaintext</span><span class="p">);</span>

<span class="cm">/* expected output:</span>

<span class="cm">The decrypted data: &quot;my data&quot;</span>

<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="passtokeyiv">
<h3>passToKeyIv<a class="headerlink" href="#passtokeyiv" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">passToKeyIv()</span></code> function performs the same password to
key/iv pair generation as <a class="reference internal" href="#encrypt">encrypt</a> above.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">kiv</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">passToKeyIv</span><span class="p">(</span><span class="nx">options</span><span class="p">);</span>
</pre></div>
</div>
<p>Where</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">options</span></code> is an <span class="green">Object</span> which may contain the following:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">cipher</span></code> is a <span class="green">String</span> and is one of the <a class="reference internal" href="#supported-modes">Supported Modes</a>
listed below.  If not specified, the default is <code class="docutils literal notranslate"><span class="pre">aes-256-cbc</span></code>.  This
option controls the key and iv length.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pass</span></code> is a <span class="green">String</span>, the password used to generate a key/iv pair.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">salt</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span>, the optional salt for generation
of the key and iv.  If not provided, a random salt will be generated.
If provided as a <span class="green">String</span> it must be a hex encoded string representing at
least 8 bytes.  If provided as a <span class="green">Buffer</span>, it must be at least 8 bytes in length.
If longer than 8 bytes, only the first 8 bytes will be used.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">iter</span></code> - number of iterations for generating a key and iv from <code class="docutils literal notranslate"><span class="pre">pass</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">10000</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">returnBuffer</span></code> is an <span class="green">Boolean</span>, if <code class="docutils literal notranslate"><span class="pre">true</span></code> the key, iv and salt will be returned
as binary data in <span class="green">Buffers</span>.  Otherwise if not set or <code class="docutils literal notranslate"><span class="pre">false</span></code>, they will be encoded as a hex
<span class="green">Strings</span>.</p></li>
</ul>
</li>
</ul>
<dl class="simple">
<dt>Return Value:</dt><dd><p>An <span class="green">Object</span> containing the key, iv and salt as hex encoded <span class="green">Strings</span> or
as binary data in <span class="green">Buffers</span>.
The function <code class="docutils literal notranslate"><span class="pre">crypto.passToKeyIv</span></code> produces the same results as
<code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">enc</span> <span class="pre">-&lt;cipher_mode&gt;</span> <span class="pre">-pbkdf2</span>&#160; <span class="pre">-k</span> <span class="pre">&lt;password&gt;</span> <span class="pre">[-S</span> <span class="pre">&lt;salt_as_hex&gt;]</span> <span class="pre">-P</span></code>
using openssl version 1.1.1 from the command line.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">salt</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">sha1</span><span class="p">(</span><span class="s2">&quot;a unique string for one time use as salt&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">kiv</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">passToKeyIv</span><span class="p">({</span>
   <span class="nx">pass</span><span class="o">:</span> <span class="s2">&quot;mypass&quot;</span><span class="p">,</span>
   <span class="nx">salt</span><span class="o">:</span> <span class="nx">salt</span>
<span class="p">});</span>

<span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">({</span>
    <span class="nx">key</span><span class="o">:</span>  <span class="nx">kiv</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span>
    <span class="nx">iv</span><span class="o">:</span>   <span class="nx">kiv</span><span class="p">.</span><span class="nx">iv</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="s2">&quot;my data&quot;</span>
<span class="p">});</span>

<span class="cm">/*</span>
<span class="cm">   note that when key/iv is used in encrypt instead of a password, salt</span>
<span class="cm">   is not stored in the ciphertext, and the ciphertext must be decrypted</span>
<span class="cm">   with the same key, iv derived using both &#39;password&#39; and &#39;salt&#39;.</span>
<span class="cm">*/</span>

<span class="kd">var</span> <span class="nx">plaintext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">({</span>
    <span class="nx">key</span><span class="o">:</span>  <span class="nx">kiv</span><span class="p">.</span><span class="nx">key</span><span class="p">,</span>
    <span class="nx">iv</span><span class="o">:</span>   <span class="nx">kiv</span><span class="p">.</span><span class="nx">iv</span><span class="p">,</span>
    <span class="nx">data</span><span class="o">:</span> <span class="nx">ciphertext</span>
<span class="p">});</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s1">&#39;Key/Iv/Salt: &quot;%3J&quot;\n\n&#39;</span><span class="p">,</span> <span class="nx">kiv</span><span class="p">);</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s1">&#39;The decrypted data: &quot;%s&quot;\n&#39;</span><span class="p">,</span> <span class="nx">plaintext</span><span class="p">);</span>

<span class="cm">/* expected output:</span>

<span class="cm">Key/Iv/Salt: &quot;{</span>
<span class="cm">   &quot;key&quot;: &quot;215a744a875c4604046f05a34164507cf9f8c54342f75b1d58ad5d1f428aadd2&quot;,</span>
<span class="cm">   &quot;iv&quot;: &quot;daffcd9ff10128eee4f19375f1aa4dde&quot;,</span>
<span class="cm">   &quot;salt&quot;: &quot;ce37ddf6cda911f4&quot;</span>
<span class="cm">}&quot;</span>

<span class="cm">The decrypted data: &quot;my data&quot;</span>

<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="supported-modes">
<h3>Supported Modes<a class="headerlink" href="#supported-modes" title="Permalink to this headline">¶</a></h3>
<p>The following cipher/modes are supported in rampart:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 36%" />
<col style="width: 64%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>mode name</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>bf-cbc</p></td>
<td><p>Blowfish in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>bf-cfb</p></td>
<td><p>Blowfish in CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>bf-ecb</p></td>
<td><p>Blowfish in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>bf-ofb</p></td>
<td><p>Blowfish in OFB mode</p></td>
</tr>
<tr class="row-even"><td><p>cast-cbc</p></td>
<td><p>CAST in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>cast5-cbc</p></td>
<td><p>CAST5 in CBC mode</p></td>
</tr>
<tr class="row-even"><td><p>cast5-cfb</p></td>
<td><p>CAST5 in CFB mode</p></td>
</tr>
<tr class="row-odd"><td><p>cast5-ecb</p></td>
<td><p>CAST5 in ECB mode</p></td>
</tr>
<tr class="row-even"><td><p>cast5-ofb</p></td>
<td><p>CAST5 in OFB mode</p></td>
</tr>
<tr class="row-odd"><td><p>des-cbc</p></td>
<td><p>DES in CBC mode</p></td>
</tr>
<tr class="row-even"><td><p>des-cfb</p></td>
<td><p>DES in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>des-ofb</p></td>
<td><p>DES in OFB mode</p></td>
</tr>
<tr class="row-even"><td><p>des-ecb</p></td>
<td><p>DES in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>des-ede-cbc</p></td>
<td><p>Two key triple DES EDE in CBC mode</p></td>
</tr>
<tr class="row-even"><td><p>des-ede</p></td>
<td><p>Two key triple DES EDE in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>des-ede-cfb</p></td>
<td><p>Two key triple DES EDE in CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>des-ede-ofb</p></td>
<td><p>Two key triple DES EDE in OFB mode</p></td>
</tr>
<tr class="row-odd"><td><p>des-ede3-cbc</p></td>
<td><p>Three key triple DES EDE in CBC mode</p></td>
</tr>
<tr class="row-even"><td><p>des-ede3</p></td>
<td><p>Three key triple DES EDE in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>des-ede3-cfb</p></td>
<td><p>Three key triple DES EDE CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>des-ede3-ofb</p></td>
<td><p>Three key triple DES EDE in OFB mode</p></td>
</tr>
<tr class="row-odd"><td><p>desx</p></td>
<td><p>DESX algorithm.</p></td>
</tr>
<tr class="row-even"><td><p>idea-cbc</p></td>
<td><p>IDEA algorithm in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>idea-cfb</p></td>
<td><p>IDEA in CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>idea-ecb</p></td>
<td><p>IDEA in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>idea-ofb</p></td>
<td><p>IDEA in OFB mode</p></td>
</tr>
<tr class="row-even"><td><p>rc2-cbc</p></td>
<td><p>128 bit RC2 in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>rc2-cfb</p></td>
<td><p>128 bit RC2 in CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>rc2-ecb</p></td>
<td><p>128 bit RC2 in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>rc2-ofb</p></td>
<td><p>128 bit RC2 in OFB mode</p></td>
</tr>
<tr class="row-even"><td><p>rc2-64-cbc</p></td>
<td><p>64 bit RC2 in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>rc2-40-cbc</p></td>
<td><p>40 bit RC2 in CBC mode</p></td>
</tr>
<tr class="row-even"><td><p>rc4</p></td>
<td><p>128 bit RC4</p></td>
</tr>
<tr class="row-odd"><td><p>rc4-40</p></td>
<td><p>40 bit RC4</p></td>
</tr>
<tr class="row-even"><td><p>aes-256-cbc</p></td>
<td><p>256 bit AES in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-256-cfb</p></td>
<td><p>256 bit AES in 128 bit CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-256-cfb1</p></td>
<td><p>256 bit AES in 1 bit CFB mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-256-cfb8</p></td>
<td><p>256 bit AES in 8 bit CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-256-ecb</p></td>
<td><p>256 bit AES in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-256-ofb</p></td>
<td><p>256 bit AES in OFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-192-cbc</p></td>
<td><p>192 bit AES in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-192-cfb</p></td>
<td><p>192 bit AES in 128 bit CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-192-cfb1</p></td>
<td><p>192 bit AES in 1 bit CFB mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-192-cfb8</p></td>
<td><p>192 bit AES in 8 bit CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-192-ecb</p></td>
<td><p>192 bit AES in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-192-ofb</p></td>
<td><p>192 bit AES in OFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-128-cbc</p></td>
<td><p>128 bit AES in CBC mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-128-cfb</p></td>
<td><p>128 bit AES in 128 bit CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-128-cfb1</p></td>
<td><p>128 bit AES in 1 bit CFB mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-128-cfb8</p></td>
<td><p>128 bit AES in 8 bit CFB mode</p></td>
</tr>
<tr class="row-even"><td><p>aes-128-ecb</p></td>
<td><p>128 bit AES in ECB mode</p></td>
</tr>
<tr class="row-odd"><td><p>aes-128-ofb</p></td>
<td><p>128 bit AES in OFB mode</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="rsa-encryption">
<h2>RSA Encryption<a class="headerlink" href="#rsa-encryption" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rsa-gen-key">
<h3>rsa_gen_key<a class="headerlink" href="#rsa-gen-key" title="Permalink to this headline">¶</a></h3>
<p>Generate an RSA key pair.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_gen_key</span><span class="p">([</span><span class="nx">bits</span><span class="p">][,</span> <span class="nx">password</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bits</span></code> is a <span class="green">Number</span> such as <code class="docutils literal notranslate"><span class="pre">1024</span></code>, <code class="docutils literal notranslate"><span class="pre">2048</span></code>
<code class="docutils literal notranslate"><span class="pre">4096</span></code> or <code class="docutils literal notranslate"><span class="pre">8192</span></code>.  The number of modulus bits.  Default
is <code class="docutils literal notranslate"><span class="pre">4096</span></code> if not specified.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">password</span></code> is an optional <span class="green">String</span>, a password to
encrypt the private key.</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Return Value:</dt><dd><p>An <span class="green">Object</span> with the following properties:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">public</span></code> - the public key in pkcs8 <code class="docutils literal notranslate"><span class="pre">pem</span></code> format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">private</span></code> - the private key in pkcs8 <code class="docutils literal notranslate"><span class="pre">pem</span></code> format, encrypted if
<code class="docutils literal notranslate"><span class="pre">password</span></code> is given.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rsa_public</span></code> - the public key in pkcs1 rsa public key <code class="docutils literal notranslate"><span class="pre">pem</span></code> format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rsa_private</span></code> - the private key in pkcs1 rsa private key <code class="docutils literal notranslate"><span class="pre">pem</span></code> format, encrypted if
<code class="docutils literal notranslate"><span class="pre">password</span></code> is given.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="cm">/* for demo - generally should be 2048 or greater */</span>
<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_gen_key</span><span class="p">(</span><span class="mi">1024</span><span class="p">,</span> <span class="s2">&quot;mypass&quot;</span><span class="p">);</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span> <span class="s2">&quot;%s\n%s\n%s\n%s\n&quot;</span><span class="p">,</span>
   <span class="nx">key</span><span class="p">.</span><span class="kr">private</span><span class="p">,</span>
   <span class="nx">key</span><span class="p">.</span><span class="kr">public</span><span class="p">,</span>
   <span class="nx">key</span><span class="p">.</span><span class="nx">rsa_private</span><span class="p">,</span>
   <span class="nx">key</span><span class="p">.</span><span class="nx">rsa_public</span>
<span class="p">);</span>

<span class="cm">/* expect output similar to the following:</span>
<span class="cm">-----BEGIN ENCRYPTED PRIVATE KEY-----</span>
<span class="cm">MIIC3TBXBgkqhkiG9w0BBQ0wSjApBgkqhkiG9w0BBQwwHAQI5x3aqPg9MqgCAggA</span>
<span class="cm">MAwGCCqGSIb3DQIJBQAwHQYJYIZIAWUDBAEqBBAoAyT6LBBnFh3Hd7HhQp+XBIIC</span>
<span class="cm">gHv1acYJPZeNkeTIVX2531fJXmRhWYC1CA6T6eb6fSTLo7ZEnX1kYA34kyhyhj0R</span>
<span class="cm">MOi1mkCZSkdsf8Z/emRCHycWcuJqtAscwpBfURHcTKTzOb2MwQ8hnNLc4lmLOwD2</span>
<span class="cm">Vp6TwqO1JRrR+xeoLuTas+vfzklaRX1c4zSfAU9S2GXdXHJbCtvnFY5HrpMnm0bb</span>
<span class="cm">5d9q0SuMXUFVQM5R5EcXwu7mwuVQbNFK1LZEggzBjdueq5mF3MDvLwaDvoOIffz1</span>
<span class="cm">dPKoj4YPwCFT/RCUhBFz16uHXKK2glPYVYQ2/LYpJK9+hKvWYLWg5veqNyu5TMjb</span>
<span class="cm">crLKvgKE0k/5eJb89hWkOTn00+pcP3b0jAF/iSSwbOokW0H7gZChjRy2CFuJf+t6</span>
<span class="cm">Gx0kndn2hV1722XDaPj+L3tQrjmatSdYEUPMLYfY8NED54GbXndBRY27zJ8ulSjS</span>
<span class="cm">GbMW6iwB2jdO5kKkZrjechLt3pJOC4W6BKlrZXESnZO9TIy1/erwMg3ppId0RtKT</span>
<span class="cm">HgC7b8q8Vw/+9rwi3ksyqWcsEC+CCOaCTjfr6JOiDG1EFQ+wBH4ysoojjo3AQGjY</span>
<span class="cm">mve01KNEBD14+SdLO1Tm6wJfHarUDV0EliSr9cXHHUTZPkFLa4n06C31GfD1McJM</span>
<span class="cm">ky9gSK59qP6n55YDEokVeT6Ei7Q+tgBftg+HisP5QUU2pzlmE5kBfb8lSizUW/Pj</span>
<span class="cm">uBoEVedCxAHQ3Yl3TrMv5URNkFhb3Prsb5YTm7lczEsmk80NAF+obl7iqii4X4Wn</span>
<span class="cm">E2QYpF370fhUmjYsA2G0xugYI+uOf6DepUUEan20SsLRWQk5cqrIFnJlNbnKzaRt</span>
<span class="cm">FaY/wG/NAIHOVONb87bu1Z4=</span>
<span class="cm">-----END ENCRYPTED PRIVATE KEY-----</span>

<span class="cm">-----BEGIN PUBLIC KEY-----</span>
<span class="cm">MIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQC7lkrZ6gREJZT6ZWjvFxrm+lPY</span>
<span class="cm">dyE1uplaTbV87AirYHfQRTef3y87B/yL/Qud3brcPUePryqNz20wxZk8hDe0PAHC</span>
<span class="cm">IcM1c3STPxAvo+YJXbjt6DmoC+UK9nkIKXLg1lR9VMVYr9Gri8KWmyXAxHdmTSpf</span>
<span class="cm">njNlXdlur240f9negQIDAQAB</span>
<span class="cm">-----END PUBLIC KEY-----</span>

<span class="cm">-----BEGIN RSA PRIVATE KEY-----</span>
<span class="cm">Proc-Type: 4,ENCRYPTED</span>
<span class="cm">DEK-Info: AES-256-CBC,19216181CEB7C4E59C2D9B8F1F8E4323</span>

<span class="cm">E+1namuNDSCDzRU2O5tq5t78zQ4EobMVNLXzy0yjA9IN1zW6IMxH5WE7wZ48/FZl</span>
<span class="cm">uRFokQrr1xMJB667U0ZtSMS0Ol3q1DZAZvOakpXV21LtKgVEO/E3XM+la5+O+hJ3</span>
<span class="cm">Nhzb58gJKnC3GfexxlxrLeFx+rXwtYNY0wZqAy9yo+QNHEE7JZgYqHipIfxhKlqx</span>
<span class="cm">hmYA5c3ztd7+j2aEq4boRWQdqL5GBzjhAOKYi7goic3SU/kQQmsu7bA7q4KqVn8P</span>
<span class="cm">l0aygNweimO9xkFuZrngdtVeZ/8nA6TsNVJOyI6NanA/iV7SuGYXczqP198P62m7</span>
<span class="cm">2sJkHGJwiR0X6tb95+0sjEofujbRv/6eFV1Tv8r42zEXkESet1XMjxOoEwBLWLbH</span>
<span class="cm">+5RThxkGLfAWDsssq6bo9ilgw2qI0xW9CEtcBmkn574+j0ScIk/2J69cyiIdJNZn</span>
<span class="cm">WNtC0mzKGHMEn+xpYsszyUbS7EgAg3LrV0irl2Kbjm3xTgtKhRXXC7lqbrBoAJF4</span>
<span class="cm">gwwfusEF9jNMoWBkl15oIuUK2/PIgd4IRVBDGX76pcjoTIeTRqulsXuxcl6GKHm9</span>
<span class="cm">KskhZBP08MlN7j4cXc7GmmO4MnzghHNUeqs3Aok2JV4ulimL/7IiaJFQvh01WVk+</span>
<span class="cm">hrQUPnjRVnSzHejBNFqCFCr9XKh72NbTr/6qvzJg8pIjNemb2Vo4rrc2ITzHcS/g</span>
<span class="cm">O88JtrnZjroB37Av6ELTrqJ/G02pdVs8i8FEb/Vnvd6MsTaSwSHJEAFMP6LqhPI0</span>
<span class="cm">ukVkqYB7E1HL0iWS3mgC7eLmWfrx6i0XSMQoWJFNKJAzOlo8K2+McluDl7x/3Cfz</span>
<span class="cm">-----END RSA PRIVATE KEY-----</span>

<span class="cm">-----BEGIN RSA PUBLIC KEY-----</span>
<span class="cm">MIGJAoGBALuWStnqBEQllPplaO8XGub6U9h3ITW6mVpNtXzsCKtgd9BFN5/fLzsH</span>
<span class="cm">/Iv9C53dutw9R4+vKo3PbTDFmTyEN7Q8AcIhwzVzdJM/EC+j5glduO3oOagL5Qr2</span>
<span class="cm">eQgpcuDWVH1UxViv0auLwpabJcDEd2ZNKl+eM2Vd2W6vbjR/2d6BAgMBAAE=</span>
<span class="cm">-----END RSA PUBLIC KEY-----</span>

<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="rsa-import-priv-key">
<h3>rsa_import_priv_key<a class="headerlink" href="#rsa-import-priv-key" title="Permalink to this headline">¶</a></h3>
<p>Import an existing private key and generate a new public and private keys.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_import_priv_key</span><span class="p">(</span><span class="nx">oldprivate_key</span><span class="p">[,</span> <span class="nx">opts</span><span class="p">]);</span>

<span class="cm">/* or */</span>

<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_import_priv_key</span><span class="p">(</span><span class="nx">oldprivate_key</span><span class="p">[,</span> <span class="nx">oldpass</span><span class="p">][,</span> <span class="nx">newpass</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">oldprivate_key</span></code> is an <span class="green">Object</span> or <span class="green">String</span>, the pem formatted private key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opts</span></code> is an <span class="green">Object</span> with the properties <code class="docutils literal notranslate"><span class="pre">{decryptPassword:</span> <span class="pre">&quot;oldpass&quot;,</span> <span class="pre">encryptPassword:</span> <span class="pre">&quot;newpass&quot;}</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">oldpass</span></code> is a <span class="green">String</span>, the password to decrypt <code class="docutils literal notranslate"><span class="pre">oldprivate_key</span></code>, if encrypted.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">newpass</span></code> is a <span class="green">String</span>, an optional password to encrypt the return private keys.</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Return Value:</dt><dd><p>An <span class="green">Object</span> with the following properties:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">public</span></code> - the public key in pkcs8 <code class="docutils literal notranslate"><span class="pre">pem</span></code> format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">private</span></code> - the private key in pkcs8 <code class="docutils literal notranslate"><span class="pre">pem</span></code> format, encrypted if
<code class="docutils literal notranslate"><span class="pre">newpass</span></code> is given.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rsa_public</span></code> - the public key in pkcs1 rsa public key <code class="docutils literal notranslate"><span class="pre">pem</span></code> format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rsa_private</span></code> - the private key in pkcs1 rsa private key <code class="docutils literal notranslate"><span class="pre">pem</span></code> format, encrypted if
<code class="docutils literal notranslate"><span class="pre">newpass</span></code> is given.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</div>
<div class="section" id="rsa-components">
<h3>rsa_components<a class="headerlink" href="#rsa-components" title="Permalink to this headline">¶</a></h3>
<p>Get the component parts of an RSA public or private key.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">components</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_components</span><span class="p">(</span><span class="nx">key</span><span class="p">);</span>
</pre></div>
</div>
<dl>
<dt>Return Value:</dt><dd><p>An <span class="green">Object</span>.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">key</span></code> is a public key, the following properties are set:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">exponent</span></code> - a <span class="green">String</span> with the hex encoded value of the exponent.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">modulus</span></code> - a <span class="green">String</span> with the hex encoded value of the modulus.</p></li>
</ul>
</div></blockquote>
<p>If <code class="docutils literal notranslate"><span class="pre">key</span></code> is a private key, in addition to the above:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">privateExponent</span></code> - a <span class="green">String</span> with the hex encoded value of the private exponent.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privateFactorq</span></code>  - a <span class="green">String</span> with the hex encoded value of the private factor <code class="docutils literal notranslate"><span class="pre">q</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">privateFactorp</span></code>  - a <span class="green">String</span> with the hex encoded value of the private factor <code class="docutils literal notranslate"><span class="pre">p</span></code>.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
</div>
<div class="section" id="rsa-pub-encrypt">
<h3>rsa_pub_encrypt<a class="headerlink" href="#rsa-pub-encrypt" title="Permalink to this headline">¶</a></h3>
<p>Encrypt data using an RSA public key.  The public key can be in either
pem format generated by <a class="reference internal" href="#rsa-gen-key">rsa_gen_key</a>().</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_pub_encrypt</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">public_key</span><span class="p">[,</span> <span class="nx">paddingMode</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the content to
encrypt.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public_key</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the content of
the public key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">paddingMode</span></code> is an optiona <span class="green">String</span> that is one of the
following (as described
<a class="reference external" href="https://www.openssl.org/docs/man1.1.1/man3/RSA_public_encrypt.html">here</a>):</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;pkcs&quot;</span></code> - default if not specified.  Use PKCS #1 v1.5 padding.
This currently is the most widely used mode.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;oaep&quot;</span></code> - Use EME-OAEP as defined in PKCS #1 v2.0 with SHA-1,
MGF1 and an empty encoding parameter. This mode is recommended for
all new applications.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;ssl&quot;</span></code> - PKCS #1 v1.5 padding with an SSL-specific modification
that denotes that the server is SSL3 capable.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;raw&quot;</span></code> - Raw RSA encryption. This mode should only be used to
implement cryptographically sound padding modes in the application
code. Encrypting user data directly with RSA is insecure.</p></li>
</ul>
</div></blockquote>
<p>Note that Openssl Library includes this warning:</p>
<p>“Decryption failures in the RSA_PKCS1_PADDING mode leak information
which can potentially be used to mount a Bleichenbacher padding oracle
attack. This is an inherent weakness in the PKCS #1 v1.5 padding
design. Prefer RSA_PKCS1_OAEP_PADDING.”  - see
<a class="reference external" href="https://www.openssl.org/docs/man1.1.1/man3/RSA_public_encrypt.html">this document</a>.</p>
<p>Note also that the length of <code class="docutils literal notranslate"><span class="pre">data</span></code> cannot be more than the number of bytes of
the modulus used to create the key pair minus 11 (or minus 42 in the case of
<code class="docutils literal notranslate"><span class="pre">&quot;oaep&quot;</span></code>, or minus 0 in the case of <code class="docutils literal notranslate"><span class="pre">raw</span></code>).</p>
</li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">Buffer</span> containing the encrypted text.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">data</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="kd">var</span> <span class="nx">str</span>  <span class="o">=</span> <span class="s2">&quot;contents of my potentially long data file...\n&quot;</span><span class="p">;</span>

<span class="cm">/* make content longer than can fit in rsa encrypted text */</span>
<span class="k">for</span> <span class="p">(</span><span class="nx">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="nx">i</span><span class="o">&lt;</span><span class="mi">100</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span>
    <span class="nx">data</span><span class="o">+=</span><span class="nx">str</span><span class="p">;</span>

<span class="cm">/* seed the random number generator before use */</span>
<span class="nx">crypto</span><span class="p">.</span><span class="nx">seed</span><span class="p">();</span>

<span class="cm">/* generate random data and base64 encode for easy use*/</span>
<span class="kd">var</span> <span class="nx">symmetric_passwd</span> <span class="o">=</span> <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">sprintf</span><span class="p">(</span><span class="s2">&quot;%B&quot;</span><span class="p">,</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rand</span><span class="p">(</span><span class="mi">48</span><span class="p">));</span>

<span class="cm">/* encrypt data using the random base64 data as the password */</span>
<span class="kd">var</span> <span class="nx">ciphertext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">encrypt</span><span class="p">(</span><span class="nx">symmetric_passwd</span><span class="p">,</span> <span class="nx">data</span><span class="p">);</span>

<span class="cm">/* rsa encrypt the password with public key */</span>
<span class="kd">var</span> <span class="nx">encrypted_passwd</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_pub_encrypt</span><span class="p">(</span>
    <span class="nx">symmetric_passwd</span><span class="p">,</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">&quot;pubkey.pem&quot;</span><span class="p">)</span>
<span class="p">);</span>

<span class="cm">/* transmit ciphertext and encrypted password to</span>
<span class="cm">   owner of the corresponding private key        */</span>
</pre></div>
</div>
</div>
<div class="section" id="rsa-priv-decrypt">
<h3>rsa_priv_decrypt<a class="headerlink" href="#rsa-priv-decrypt" title="Permalink to this headline">¶</a></h3>
<p>Decrypt encrypted data using an RSA private key. The private key can be in either
pem format generated by <a class="reference internal" href="#rsa-gen-key">rsa_gen_key</a>().</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_priv_decrypt</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">private_key</span><span class="p">[,</span> <span class="nx">paddingMode</span><span class="p">][,</span> <span class="nx">password</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the content to
decrypt.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">private_key</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the contents of the
private key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">paddingMode</span></code> - a <span class="green">String</span>. See above - the same padding mode used to encrypt
the data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">password</span></code> - a <span class="green">String</span>, if <code class="docutils literal notranslate"><span class="pre">private_key</span></code> is password
protected, the password used to encrypt the private key.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">Buffer</span> containing the decrypted text.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="cm">/* continuing example from above, owner of privatekey.pem can do this */</span>
<span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="cm">/* receive ciphertext and encrypted password from above */</span>

<span class="nx">symmetric_passwd</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_priv_decrypt</span><span class="p">(</span>
    <span class="nx">encrypted_passwd</span><span class="p">,</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="s2">&quot;privatekey.pem&quot;</span><span class="p">),</span>
    <span class="kc">null</span><span class="p">,</span> <span class="cm">/* use default &quot;pkcs&quot; */</span>
    <span class="s2">&quot;mysecretpassword&quot;</span>
<span class="p">);</span>

<span class="cm">/* decrypt message</span>
<span class="cm">   password must be a string */</span>
<span class="kd">var</span> <span class="nx">plaintext</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">decrypt</span><span class="p">(</span>
    <span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">bufferToString</span><span class="p">(</span><span class="nx">symmetric_passwd</span><span class="p">),</span>
    <span class="nx">ciphertext</span>
<span class="p">);</span>

<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">printf</span><span class="p">(</span><span class="s2">&quot;%s&quot;</span><span class="p">,</span> <span class="nx">plaintext</span><span class="p">);</span>

<span class="cm">/* expected output:</span>
<span class="cm">contents of my potentially long data file...</span>
<span class="cm">contents of my potentially long data file...</span>
<span class="cm">...</span>
<span class="cm">contents of my potentially long data file...</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="rsa-sign">
<h3>rsa_sign<a class="headerlink" href="#rsa-sign" title="Permalink to this headline">¶</a></h3>
<p>Sign a message with an RSA private key. The private key can be in either
pem format generated by <a class="reference internal" href="#rsa-gen-key">rsa_gen_key</a>().</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">signature</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_sign</span><span class="p">(</span><span class="nx">message</span><span class="p">,</span> <span class="nx">private_key</span><span class="p">[,</span> <span class="nx">password</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">message</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the content to
sign.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">private_key</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the contents of the
private key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">password</span></code> - a <span class="green">String</span>, if <code class="docutils literal notranslate"><span class="pre">private_key</span></code> is password
protected, the password used to encrypt the private key.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">Buffer</span> with the content of the signature.  Same as
<code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">dgst</span> <span class="pre">-sha256</span> <span class="pre">-sign</span> <span class="pre">private_key.pem</span> <span class="pre">-out</span> <span class="pre">sig</span> <span class="pre">msg.txt</span></code></p>
</dd>
</dl>
</div>
<div class="section" id="rsa-verify">
<h3>rsa_verify<a class="headerlink" href="#rsa-verify" title="Permalink to this headline">¶</a></h3>
<p>Verify a signed message with an RSA public key. The public key can be in either
pem format generated by <a class="reference internal" href="#rsa-gen-key">rsa_gen_key</a>().</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">verified</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_verify</span><span class="p">(</span><span class="nx">data</span><span class="p">,</span> <span class="nx">public_key</span><span class="p">,</span> <span class="nx">signature</span><span class="p">);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the content to
verify.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">public_key</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span> with the contents of the
public key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">signature</span></code> - a <span class="green">Buffer</span> containing the signature
generated with <code class="docutils literal notranslate"><span class="pre">rsa_sign</span></code> above, or with openssl.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">Boolean</span> - <code class="docutils literal notranslate"><span class="pre">true</span></code> if verification succeeded.  Otherwise
<code class="docutils literal notranslate"><span class="pre">false</span></code>. Same as
<code class="docutils literal notranslate"><span class="pre">openssl</span> <span class="pre">dgst</span> <span class="pre">-sha256</span> <span class="pre">-verify</span> <span class="pre">public_key.pem</span> <span class="pre">-signature</span> <span class="pre">sig</span> <span class="pre">msg.txt</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="gen-csr">
<h3>gen_csr<a class="headerlink" href="#gen-csr" title="Permalink to this headline">¶</a></h3>
<p>Generate a certificate signing request.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">csr</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">gen_csr</span><span class="p">(</span><span class="nx">private_key</span><span class="p">,</span> <span class="nx">opts</span><span class="p">[,</span> <span class="nx">password</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">private_key</span></code> is a <span class="green">String</span>, a pem formatted private key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">opts</span></code> is an <span class="green">Object</span>, with the following optional property <span class="green">Strings</span>:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code> - The “Common Name”, usually the relevant domain name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">country</span></code> - A two letter country code (i.e. <code class="docutils literal notranslate"><span class="pre">US</span></code> or <code class="docutils literal notranslate"><span class="pre">DE</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">state</span></code> - State or Province name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">city</span></code> - The locality or city of your organization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">organization</span></code> - The full legal name of your organization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">organizationUnit</span></code> - The department of your organization.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">email</span></code> - Contact email.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subjectAltName</span></code> - text to be placed in the <code class="docutils literal notranslate"><span class="pre">Attributes</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">Requested</span> <span class="pre">Extensions</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">X509v3</span> <span class="pre">Subject</span> <span class="pre">Alternative</span> <span class="pre">Name</span></code>
section of the certificate request.  Also accepts an <span class="green">Array</span> of <span class="green">Strings</span> for multiple values.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">subjectAltNameType</span></code> - The type used for values in <code class="docutils literal notranslate"><span class="pre">subjectAltName</span></code>.  If, e.g., <code class="docutils literal notranslate"><span class="pre">dns</span></code> is set and <code class="docutils literal notranslate"><span class="pre">subjectAltName</span></code> is set to
<code class="docutils literal notranslate"><span class="pre">[&quot;example.com&quot;,</span> <span class="pre">&quot;www.example.com&quot;]</span></code>, the certificate signing request will include the
<code class="docutils literal notranslate"><span class="pre">X509v3</span> <span class="pre">Subject</span> <span class="pre">Alternative</span> <span class="pre">Name</span></code> value of <code class="docutils literal notranslate"><span class="pre">DNS:example.com,</span> <span class="pre">DNS:www.example.com</span></code>.  Possible values are <code class="docutils literal notranslate"><span class="pre">dns</span></code> (the
default if not specified), <code class="docutils literal notranslate"><span class="pre">ip</span></code>, <code class="docutils literal notranslate"><span class="pre">email</span></code>, <code class="docutils literal notranslate"><span class="pre">uri</span></code>, <code class="docutils literal notranslate"><span class="pre">x400</span></code>, <code class="docutils literal notranslate"><span class="pre">dirname</span></code>, <code class="docutils literal notranslate"><span class="pre">rid</span></code> or <code class="docutils literal notranslate"><span class="pre">othername</span></code> (case insensitive).
See openssl documentation for meaning and usage of each.  For requesting an SSL/TLS certificate for a webserver, <code class="docutils literal notranslate"><span class="pre">dns</span></code>
should be used, particularily where the requested certificate will cover more than one domain name.</p></li>
</ul>
</div></blockquote>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">password</span></code> - if <code class="docutils literal notranslate"><span class="pre">private_key</span></code> is password protected, the password to decrypt the private key.</p></li>
</ul>
</div></blockquote>
<dl>
<dt>Return Value:</dt><dd><p>A <span class="green">Object</span> with the following properties:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">pem</span></code> - A <span class="green">String</span> - the generated certificate signing request in pem format.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">der</span></code> - A <span class="green">Buffer</span> - the generated certificate signing request in der binary format.</p></li>
</ul>
</div></blockquote>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="cm">/* generate a server key */</span>
<span class="kd">var</span> <span class="nx">key</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rsa_gen_key</span><span class="p">(</span><span class="mi">4096</span> <span class="cm">/* ,&quot;password&quot; */</span><span class="p">);</span>

<span class="cm">/* save it for use with webserver */</span>
<span class="nx">rampart</span><span class="p">.</span><span class="nx">utils</span><span class="p">.</span><span class="nx">fprintf</span><span class="p">(</span><span class="s2">&quot;./server.key&quot;</span><span class="p">,</span> <span class="s1">&#39;%s&#39;</span><span class="p">,</span> <span class="nx">key</span><span class="p">.</span><span class="kr">private</span><span class="p">);</span>

<span class="cm">/* generate a signing request for current domains */</span>
<span class="kd">var</span> <span class="nx">csr</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">gen_csr</span><span class="p">(</span>
    <span class="nx">key</span><span class="p">.</span><span class="kr">private</span><span class="p">,</span>
    <span class="p">{</span>
        <span class="nx">name</span><span class="o">:</span> <span class="s2">&quot;example.com&quot;</span><span class="p">,</span>
        <span class="nx">subjectAltName</span><span class="o">:</span> <span class="p">[</span><span class="s2">&quot;example.com&quot;</span><span class="p">,</span> <span class="s2">&quot;www.example.com&quot;</span><span class="p">]</span>
    <span class="p">}</span>
    <span class="cm">/* , &quot;password&quot; */</span>
<span class="p">);</span>
<span class="cm">/* csr == {pem: pem_formatted_csr, der: der_formatted_csr} */</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="hashing">
<h2>Hashing<a class="headerlink" href="#hashing" title="Permalink to this headline">¶</a></h2>
<div class="section" id="hash">
<h3>hash<a class="headerlink" href="#hash" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">hash()</span></code> function calculates a hash of the data in a <span class="green">String</span> or
<span class="green">Buffer</span> and returns it in a hex encoded <span class="green">String</span> or as
binary data in a <span class="green">Buffer</span>.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">hash</span><span class="p">(</span><span class="nx">data</span><span class="p">[,</span> <span class="nx">hash_func</span><span class="p">][,</span> <span class="nx">return_buffer</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span>, the data to be
hashed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash_func</span></code> is an optional <span class="green">String</span>, one of the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">sha1</span></code>, <code class="docutils literal notranslate"><span class="pre">sha224</span></code>, <code class="docutils literal notranslate"><span class="pre">sha256</span></code>, <code class="docutils literal notranslate"><span class="pre">sha384</span></code>, <code class="docutils literal notranslate"><span class="pre">sha512</span></code>, <code class="docutils literal notranslate"><span class="pre">md4</span></code>, <code class="docutils literal notranslate"><span class="pre">md5</span></code>, <code class="docutils literal notranslate"><span class="pre">sha3-224</span></code>,
<code class="docutils literal notranslate"><span class="pre">sha3-256</span></code>, <code class="docutils literal notranslate"><span class="pre">sha3-384</span></code>, <code class="docutils literal notranslate"><span class="pre">sha3-512</span></code>, <code class="docutils literal notranslate"><span class="pre">blake2b512</span></code>, <code class="docutils literal notranslate"><span class="pre">blake2s256</span></code>, <code class="docutils literal notranslate"><span class="pre">mdc2</span></code>,
<code class="docutils literal notranslate"><span class="pre">rmd160</span></code>, <code class="docutils literal notranslate"><span class="pre">sha512-224</span></code>, <code class="docutils literal notranslate"><span class="pre">sha512-256</span></code>, <code class="docutils literal notranslate"><span class="pre">shake128</span></code>, <code class="docutils literal notranslate"><span class="pre">shake256</span></code>,
<code class="docutils literal notranslate"><span class="pre">sm3</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">sha256</span></code>.</p>
</li>
<li><p>return_buffer is a <span class="green">Boolean</span>, if <code class="docutils literal notranslate"><span class="pre">true</span></code>, the output will be
binary data in a <span class="green">Buffer</span>, and not hex encoded.</p></li>
</ul>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">String</span> or <span class="green">Buffer</span>, the hash of the data.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">hash</span><span class="p">(</span><span class="s2">&quot;hello world&quot;</span><span class="p">,</span> <span class="s2">&quot;sha256&quot;</span><span class="p">);</span>

<span class="cm">/*</span>
<span class="cm">    res == &#39;b94d27b9934d3e08a52e52d7da7dabfac484efe37a5380ee9088f7ace2efcde9&#39;</span>
<span class="cm">*/</span>
</pre></div>
</div>
</div>
<div class="section" id="alias-functions">
<h3>alias functions<a class="headerlink" href="#alias-functions" title="Permalink to this headline">¶</a></h3>
<p>The hash function has an alias for each of the possible <code class="docutils literal notranslate"><span class="pre">hash_func</span></code>
value above.  Thus, using <code class="docutils literal notranslate"><span class="pre">crypto.hash(&quot;hello</span> <span class="pre">world&quot;,</span> <span class="pre">&quot;sha256&quot;)</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">crypto.sha256(&quot;hello</span> <span class="pre">world&quot;)</span></code>.  For <code class="docutils literal notranslate"><span class="pre">hash_func</span></code> names with a dash
(<code class="docutils literal notranslate"><span class="pre">-</span></code>), an underscore (<code class="docutils literal notranslate"><span class="pre">_</span></code>) is used instead.  Thus
<code class="docutils literal notranslate"><span class="pre">crypto.hash(&quot;hello</span> <span class="pre">world&quot;,</span> <span class="pre">&quot;sha3-256&quot;)</span></code> is equivalent to
<code class="docutils literal notranslate"><span class="pre">crypto.sha3_256(&quot;hello</span> <span class="pre">world&quot;)</span></code>.</p>
</div>
<div class="section" id="hmac">
<h3>hmac<a class="headerlink" href="#hmac" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">hmac()</span></code> function computes a HMAC from the provided data and key.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">hmac</span><span class="p">(</span><span class="nx">secret</span><span class="p">,</span> <span class="nx">data</span><span class="p">[,</span> <span class="nx">hash_func</span><span class="p">][,</span> <span class="nx">return_buffer</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where:</p>
<blockquote>
<div><ul>
<li><p><code class="docutils literal notranslate"><span class="pre">secret</span></code> is the HMAC function key.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data</span></code> is a <span class="green">String</span> or <span class="green">Buffer</span>, the data to be
hashed.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">hash_func</span></code> is an optional <span class="green">String</span>, one of the following:</p>
<p><code class="docutils literal notranslate"><span class="pre">sha1</span></code>, <code class="docutils literal notranslate"><span class="pre">sha224</span></code>, <code class="docutils literal notranslate"><span class="pre">sha256</span></code>, <code class="docutils literal notranslate"><span class="pre">sha384</span></code>, <code class="docutils literal notranslate"><span class="pre">sha512</span></code>, <code class="docutils literal notranslate"><span class="pre">md4</span></code>, <code class="docutils literal notranslate"><span class="pre">md5</span></code>, <code class="docutils literal notranslate"><span class="pre">sha3-224</span></code>,
<code class="docutils literal notranslate"><span class="pre">sha3-256</span></code>, <code class="docutils literal notranslate"><span class="pre">sha3-384</span></code>, <code class="docutils literal notranslate"><span class="pre">sha3-512</span></code>, <code class="docutils literal notranslate"><span class="pre">blake2b512</span></code>, <code class="docutils literal notranslate"><span class="pre">blake2s256</span></code>, <code class="docutils literal notranslate"><span class="pre">mdc2</span></code>,
<code class="docutils literal notranslate"><span class="pre">rmd160</span></code>, <code class="docutils literal notranslate"><span class="pre">sha512-224</span></code>, <code class="docutils literal notranslate"><span class="pre">sha512-256</span></code>,
<code class="docutils literal notranslate"><span class="pre">sm3</span></code>. Default is <code class="docutils literal notranslate"><span class="pre">sha256</span></code>.</p>
</li>
<li><p>return_buffer is a <span class="green">Boolean</span>, if <code class="docutils literal notranslate"><span class="pre">true</span></code>, the output will be
binary data in a <span class="green">Buffer</span>, and not hex encoded.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt>Return Value:</dt><dd><p>A <span class="green">String</span> or <span class="green">Buffer</span>, the hmac hash of the data.</p>
</dd>
</dl>
</div>
</div>
<div class="section" id="random">
<h2>Random<a class="headerlink" href="#random" title="Permalink to this headline">¶</a></h2>
<div class="section" id="rand">
<h3>rand<a class="headerlink" href="#rand" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">rand()</span></code> function returns random generated bytes in a buffer.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">rand</span><span class="p">(</span><span class="nx">nBytes</span><span class="p">);</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">nBytes</span></code> is the number of bytes to return.</p>
<dl class="simple">
<dt>Return Value:</dt><dd><p>a <span class="green">Buffer</span> with <code class="docutils literal notranslate"><span class="pre">nBytes</span></code> bytes of random data.</p>
</dd>
</dl>
</div>
<div class="section" id="randnum">
<h3>randnum<a class="headerlink" href="#randnum" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">randnum()</span></code> function returns a random <span class="green">Number</span>
between <code class="docutils literal notranslate"><span class="pre">0.0</span></code> and <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</div>
<div class="section" id="gaussrand">
<h3>gaussrand<a class="headerlink" href="#gaussrand" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">gaussrand([sigma])</span></code> function returns a random <span class="green">Number</span> based on
a normal distribution centered at zero (<code class="docutils literal notranslate"><span class="pre">0.0</span></code>), where <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is one
standard deviation.  <code class="docutils literal notranslate"><span class="pre">sigma</span></code> is optional, defaulting to <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
</div>
<div class="section" id="normrand">
<h3>normrand<a class="headerlink" href="#normrand" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">normrand([scale])</span></code> function returns a random <span class="green">Number</span> based on
a normal distribution centered at zero (<code class="docutils literal notranslate"><span class="pre">0.0</span></code>) and clamped between <code class="docutils literal notranslate"><span class="pre">-scale</span></code>
and <code class="docutils literal notranslate"><span class="pre">scale</span></code>.</p>
<p>Similar to the <a class="reference internal" href="#gaussrand">gaussrand</a> above.  It is equivelant to:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">nrand</span> <span class="o">=</span> <span class="nx">scale</span> <span class="o">*</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">gaussrand</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span><span class="o">/</span><span class="mf">5.0</span><span class="p">;</span>

<span class="k">if</span><span class="p">(</span><span class="nx">nrand</span><span class="o">&gt;</span><span class="nx">scale</span><span class="p">)</span>
    <span class="nx">nrand</span><span class="o">=</span><span class="nx">scale</span><span class="p">;</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="nx">nrand</span> <span class="o">&lt;</span> <span class="o">-</span><span class="nx">scale</span><span class="p">)</span>
    <span class="nx">nrand</span> <span class="o">=</span> <span class="o">-</span><span class="nx">scale</span><span class="p">;</span>
</pre></div>
</div>
<p>With a <code class="docutils literal notranslate"><span class="pre">scale</span></code> of <code class="docutils literal notranslate"><span class="pre">1.0</span></code> (the default), the distribution of numbers has a
standard deviation of <code class="docutils literal notranslate"><span class="pre">0.2</span></code>.</p>
</div>
<div class="section" id="seed">
<h3>seed<a class="headerlink" href="#seed" title="Permalink to this headline">¶</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">seed()</span></code> function seeds the random number generator from a file.
There is no return value.</p>
<p>Usage:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">seed</span><span class="p">([</span><span class="nx">options</span><span class="p">]);</span>
</pre></div>
</div>
<p>Where options is an <span class="green">Object</span>, if provided, and contains the following
properties:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">file</span></code> - a <span class="green">String</span> - location of the file.  Default is
<code class="docutils literal notranslate"><span class="pre">/dev/urandom</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">bytes</span></code> - a <span class="green">Number</span> - Number of bytes to retrieve from <code class="docutils literal notranslate"><span class="pre">file</span></code>.
Default is <code class="docutils literal notranslate"><span class="pre">32</span></code>.</p></li>
</ul>
</div>
</div>
<div class="section" id="bigint">
<h2>BigInt<a class="headerlink" href="#bigint" title="Permalink to this headline">¶</a></h2>
<p>The rampart-crypto module includes functions which handle arbitrarily long
integers using openssl’s <code class="docutils literal notranslate"><span class="pre">BIGNUM</span></code> library.  It is designed to be compatible with the
<a class="reference external" href="https://github.com/GoogleChromeLabs/jsbi">JSBI</a> library and includes the
same published functions.  See <a class="reference external" href="https://www.npmjs.com/package/jsbi">JSBI Node Module</a>
for more information.</p>
<p>Usage as documented below is as such:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">JSBI</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">JSBI</span><span class="p">;</span>
</pre></div>
</div>
<div class="section" id="jsbi-bigint">
<h3>JSBI.BigInt<a class="headerlink" href="#jsbi-bigint" title="Permalink to this headline">¶</a></h3>
<p>Create a BigInt from a <span class="green">String</span> or <span class="green">Number</span>.</p>
<p>Possible Strings:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1234</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-1234</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">0x123e</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-0x123e</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-0b11110011</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">-0b11110011</span></code></p></li>
</ul>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">JSBI</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">JSBI</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">mybignum</span> <span class="o">=</span> <span class="nx">JSBI</span><span class="p">.</span><span class="nx">BigInt</span><span class="p">(</span><span class="s2">&quot;123456789012345678901234567890&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="jsbi-compatible-functions">
<h3>JSBI Compatible functions<a class="headerlink" href="#jsbi-compatible-functions" title="Permalink to this headline">¶</a></h3>
<p>JSBI functions aspire to operate in a manner that mirrors the
<a class="reference external" href="https://www.npmjs.com/package/jsbi">JSBI</a> library.  Please
see that library for details.  Available commands include:</p>
<p><code class="docutils literal notranslate"><span class="pre">JSBI.BigInt(num).toString()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.toNumber()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.asIntN()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.asUintN()</span></code>,
<code class="docutils literal notranslate"><span class="pre">a</span> <span class="pre">instanceof</span> <span class="pre">JSBI</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.add()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.subtract()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.multiply()</span></code>,
<code class="docutils literal notranslate"><span class="pre">JSBI.divide()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.remainder()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.exponentiate()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.unaryMinus()</span></code>,
<code class="docutils literal notranslate"><span class="pre">JSBI.bitwiseNot()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.leftShift()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.signedRightShift()</span></code>,
<code class="docutils literal notranslate"><span class="pre">JSBI.bitwiseAnd()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.bitwiseOr()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.bitwiseXor()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.equal()</span></code>,
<code class="docutils literal notranslate"><span class="pre">JSBI.notEqual()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.lessThan()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.lessThanOrEqual()</span></code>,
<code class="docutils literal notranslate"><span class="pre">JSBI.greaterThan()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.greaterThanOrEqual()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.EQ()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.NE()</span></code>,
<code class="docutils literal notranslate"><span class="pre">JSBI.LT()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.LE()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.GT()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.GE()</span></code>, <code class="docutils literal notranslate"><span class="pre">JSBI.ADD()</span></code>.</p>
<p>Note that in rampart, <code class="docutils literal notranslate"><span class="pre">JSBI.BigInt().toString()</span></code> only accepts <code class="docutils literal notranslate"><span class="pre">2</span></code>, <code class="docutils literal notranslate"><span class="pre">10</span></code> and <code class="docutils literal notranslate"><span class="pre">16</span></code>
as possible arguments, with <code class="docutils literal notranslate"><span class="pre">10</span></code> being the default.</p>
</div>
<div class="section" id="tosignedstring">
<h3>toSignedString<a class="headerlink" href="#tosignedstring" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">JSBI.BigInt().toSignedString()</span></code> will convert a BigInt into a
string representing the equivalent signed number.  This differs from <code class="docutils literal notranslate"><span class="pre">JSBI.BigInt().toString()</span></code>
only when used for a signed binary integer (using <code class="docutils literal notranslate"><span class="pre">JSBI.BigInt(num).toSignedString(2)</span></code>).</p>
<p>Example:</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="kd">var</span> <span class="nx">crypto</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s2">&quot;rampart-crypto&quot;</span><span class="p">);</span>

<span class="kd">var</span> <span class="nx">JSBI</span> <span class="o">=</span> <span class="nx">crypto</span><span class="p">.</span><span class="nx">JSBI</span><span class="p">;</span>

<span class="kd">var</span> <span class="nx">mybignum</span> <span class="o">=</span> <span class="nx">JSBI</span><span class="p">.</span><span class="nx">BigInt</span><span class="p">(</span><span class="s2">&quot;-256&quot;</span><span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">mybignum</span><span class="p">.</span><span class="nx">toString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span> <span class="nx">mybignum</span><span class="p">.</span><span class="nx">toSignedString</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="p">);</span>

<span class="cm">/* expected output:</span>

<span class="cm">-100000000</span>
<span class="cm">1111111100000000</span>

<span class="cm">*/</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="rampart-curl.html" class="btn btn-neutral float-right" title="The rampart-curl module" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="rampart-html.html" class="btn btn-neutral" title="The rampart-server HTML module" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2022, Moat Crossing Systems.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ❤️  using a custom <a href="https://github.com/LinxiFan/Sphinx-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>