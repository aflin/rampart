

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Geographical coordinate functions &mdash; Rampart 0.1.0 documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  
    <link rel="stylesheet" href="../_static/hacks.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="Rampart 0.1.0 documentation" href="../index.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> Rampart
          

          
          </a>

          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../rampart-main.html">Rampart Javascript</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sqltoc.html">The rampart-sql module</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Rampart</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Geographical coordinate functions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/old/funcs-geo.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="geographical-coordinate-functions">
<h1>Geographical coordinate functions<a class="headerlink" href="#geographical-coordinate-functions" title="Permalink to this headline">¶</a></h1>
<p>The geographical coordinate functions allow for efficient processing of
latitude / longitude operations. They allow for the conversion of a
latitude/longitude pair into a single “geocode”, which is a single
<code class="docutils literal notranslate"><span class="pre">long</span></code> value that contains both values. This can be used to easily
compare it to other geocodes (for distance calculations) or for finding
other geocodes that are within a certain distance.</p>
<div class="section" id="azimuth2compass">
<h2>azimuth2compass<a class="headerlink" href="#azimuth2compass" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">azimuth2compass</span><span class="p">(</span><span class="n">double</span> <span class="n">azimuth</span> <span class="p">[,</span> <span class="nb">int</span> <span class="n">resolution</span> <span class="p">[,</span> <span class="nb">int</span> <span class="n">verbosity</span><span class="p">]])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">azimuth2compass</span></code> function converts a numerical azimuth value
(degrees of rotation from 0 degrees north) and converts it into a
compass heading, such as <code class="docutils literal notranslate"><span class="pre">N</span></code> or <code class="docutils literal notranslate"><span class="pre">Southeast</span></code>. The exact text returned
is controlled by two optional parameters, <code class="docutils literal notranslate"><span class="pre">resolution</span></code> and
<code class="docutils literal notranslate"><span class="pre">verbosity</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">Resolution</span></code> determines how fine-grained the values returned are.
There are 4 possible values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> - Only the four cardinal directions are used (N, E, S, W)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> <em>(default) - Inter-cardinal directions (N, NE, E, etc.)</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> - In-between inter-cardinal directions (N, NNE, NE, ENE, E,
etc.)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> - “by” values (N, NbE, NNE, NEbN, NE, NEbE, ENE, EbN, E, etc.)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Verbosity</span></code> affects how verbose the resulting text is. There are two
possible values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> <em>(default) - Use initials for direction values (N, NbE, NNE,
etc.)</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> - Use full text for direction values (North, North by east,
North-northeast, etc.)</p></li>
</ul>
<p>For an azimuth value of <code class="docutils literal notranslate"><span class="pre">105</span></code>, here are some example results of
<code class="docutils literal notranslate"><span class="pre">azimuth2compass</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">azimuth2compass</span><span class="p">(</span><span class="mi">105</span><span class="p">):</span> <span class="n">E</span>
<span class="n">azimuth2compass</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="mi">3</span><span class="p">):</span> <span class="n">ESE</span>
<span class="n">azimuth2compass</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span> <span class="n">EbS</span>
<span class="n">azimuth2compass</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">East</span>
<span class="n">azimuth2compass</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">East</span><span class="o">-</span><span class="n">southeast</span>
<span class="n">azimuth2compass</span><span class="p">(</span><span class="mi">105</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span> <span class="n">East</span> <span class="n">by</span> <span class="n">south</span>
</pre></div>
</div>
</div>
<div class="section" id="azimuthgeocode">
<h2>azimuthgeocode<a class="headerlink" href="#azimuthgeocode" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">azimuthgeocode</span><span class="p">(</span><span class="n">geocode1</span><span class="p">,</span> <span class="n">geocode2</span> <span class="p">[,</span> <span class="n">method</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">azimuthgeocode</span></code> function calculates the directional heading going
from one geocode to another. It returns a number between 0-360 where 0
is north, 90 east, etc., up to 360 being north again.</p>
<p>The third, optional <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter can be used to specify which
mathematical method is used to calculate the direction. There are two
possible values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">greatcircle</span></code> <em>(default)</em> - The “Great Circle” method is a highly
accurate tool for calculating distances and directions on a sphere.
It is used by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pythagorean</span></code> - Calculations based on the pythagorean method can
also be used. They’re faster, but less accurate as the core formulas
don’t take the curvature of the earth into consideration. Some
internal adjustments are made, but the values are less accurate than
the <code class="docutils literal notranslate"><span class="pre">greatcircle</span></code> method, especially over long distances and with
paths that approach the poles.</p></li>
</ul>
</div>
<div class="section" id="azimuthlatlon">
<h2>azimuthlatlon<a class="headerlink" href="#azimuthlatlon" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">azimuthlatlon</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span><span class="p">,</span> <span class="p">[,</span> <span class="n">method</span><span class="p">])</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">azimuthlatlon</span></code> function calculates the directional heading going
from one latitude-longitude point to another. It operates identically to
<a class="reference internal" href="#azimuthgeocode">azimuthgeocode</a>, except azimuthlatlon takes its parameters in a pair
of latitude-longitude points instead of geocode values.</p>
<p>The third, optional <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter can be used to specify which
mathematical method is used to calculate the direction. There are two
possible values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">greatcircle</span></code> <em>(default)</em> - The “Great Circle” method is a highly
accurate tool for calculating distances and directions on a sphere.
It is used by default.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">pythagorean</span></code> - Calculations based on the pythagorean method can
also be used. They’re faster, but less accurate as the core formulas
don’t take the curvature of the earth into consideration. Some
internal adjustments are made, but the values are less accurate than
the <code class="docutils literal notranslate"><span class="pre">greatcircle</span></code> method, especially over long distances and with
paths that approach the poles.</p></li>
</ul>
</div>
<div class="section" id="dms2dec-dec2dms">
<span id="dms-dec"></span><h2>dms2dec, dec2dms<a class="headerlink" href="#dms2dec-dec2dms" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dms2dec</span><span class="p">(</span><span class="n">dms</span><span class="p">)</span>
<span class="n">dec2dms</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dms2dec</span></code> and <code class="docutils literal notranslate"><span class="pre">dec2dms</span></code> functions are for changing back and
forth between the “degrees minutes seconds”
(DMS) format (west-positive) and “decimal degree” format for latitude
and longitude coordinates. All SQL geographical functions expect decimal
degree parameters.</p>
<p>DMS values are of the format <span class="math notranslate nohighlight">\(DDDMMSS\)</span>. For example,
3515’ would be represented as 351500.</p>
<p>In decimal degrees, a degree is a whole digit, and minutes &amp; seconds are
represented as fractions of a degree. Therefore, 3515’ would be 35.25 in
decimal degrees.</p>
<p>Note that the Texis DMS format has <em>west</em>-positive longitudes
(unlike ISO 6709 DMS format), and decimal degrees have <em>east</em>-positive
longitudes. It is up to the caller to flip the sign of longitudes where
needed.</p>
</div>
<div class="section" id="distgeocode">
<h2>distgeocode<a class="headerlink" href="#distgeocode" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distgeocode</span><span class="p">(</span><span class="n">geocode1</span><span class="p">,</span> <span class="n">geocode2</span> <span class="p">[,</span> <span class="n">method</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">distgeocode</span></code> function calculates the distance, in miles, between
two given geocodes. It uses the “Great Circle” method for calculation by
default, which is very accurate. A faster, but less accurate,
calculation can be done with the Pythagorean theorem. It is not designed
for distances on a sphere, however, and becomes somewhat inaccurate at
larger distances and on paths that approach the poles. To use the
Pythagorean theorem, pass a third string parameter, “<code class="docutils literal notranslate"><span class="pre">pythagorean</span></code>”,
to force that method. “<code class="docutils literal notranslate"><span class="pre">greatcircle</span></code>” can also be specified as a
method.</p>
<p>For example:</p>
<ul class="simple">
<li><p>New York (JFK) to Cleveland (CLE), the Pythagorean method is off by
.8 miles (.1%)</p></li>
<li><p>New York (JFK) to Los Angeles (LAX), the Pythagorean method is off by
22.2 miles (.8%)</p></li>
<li><p>New York (JFK) to South Africa (PLZ), the Pythagorean method is off
by 430 miles (5.2%)</p></li>
</ul>
<p>See Also: <a class="reference internal" href="#distlatlon">distlatlon</a></p>
</div>
<div class="section" id="distlatlon">
<h2>distlatlon<a class="headerlink" href="#distlatlon" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">distlatlon</span><span class="p">(</span><span class="n">lat1</span><span class="p">,</span> <span class="n">lon1</span><span class="p">,</span> <span class="n">lat2</span><span class="p">,</span> <span class="n">lon2</span> <span class="p">[,</span> <span class="n">method</span><span class="p">]</span> <span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">distlatlon</span></code> function calculates the distance, in miles, between
two points, represented in latitude/longitude pairs in decimal degree
format.</p>
<p>Like <a class="reference internal" href="#distgeocode">distgeocode</a>, it uses the “Great Circle” method by default, but
can be overridden to use the faster, less accurate Pythagorean method if
“<code class="docutils literal notranslate"><span class="pre">pythagorean</span></code>” is passed as the optional <code class="docutils literal notranslate"><span class="pre">method</span></code> parameter.</p>
<p>For example:</p>
<ul class="simple">
<li><p>New York (JFK) to Cleveland (CLE), the Pythagorean method is off by
.8 miles (.1%)</p></li>
<li><p>New York (JFK) to Los Angeles (LAX), the Pythagorean method is off by
22.2 miles (.8%)</p></li>
<li><p>New York (JFK) to South Africa (PLZ), the Pythagorean method is off
by 430 miles (5.2%)</p></li>
</ul>
<p>See Also: <a class="reference internal" href="#distgeocode">distgeocode</a></p>
</div>
<div class="section" id="latlon2geocode-latlon2geocodearea">
<span id="latlon2x"></span><h2>latlon2geocode, latlon2geocodearea<a class="headerlink" href="#latlon2geocode-latlon2geocodearea" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">latlon2geocode</span><span class="p">(</span><span class="n">lat</span><span class="p">[,</span> <span class="n">lon</span><span class="p">])</span>
<span class="n">latlon2geocodearea</span><span class="p">(</span><span class="n">lat</span><span class="p">[,</span> <span class="n">lon</span><span class="p">],</span> <span class="n">radius</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">latlon2geocode</span></code> function encodes a given latitude/longitude
coordinate into one <code class="docutils literal notranslate"><span class="pre">long</span></code> return value. This encoded value – a
“geocode” value – can be indexed and used with a special variant of
Texis’ <code class="docutils literal notranslate"><span class="pre">BETWEEN</span></code> operator for bounded-area searches of a geographical
region.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">latlon2geocodearea</span></code> function generates a bounding area centered
on the coordinate. It encodes a given latitude/longitude coordinate into
a <em>two-</em> value <code class="docutils literal notranslate"><span class="pre">varlong</span></code>. The returned geocode value pair represents
the southwest and northeast corners of a square box centered on the
latitude/longitude coordinate, with sides of length two times <code class="docutils literal notranslate"><span class="pre">radius</span></code>
(in decimal degrees). This bounding area can be used with the Texis
<code class="docutils literal notranslate"><span class="pre">BETWEEN</span></code> operator for fast geographical searches.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">lat</span></code> and <code class="docutils literal notranslate"><span class="pre">lon</span></code> parameters are <code class="docutils literal notranslate"><span class="pre">double</span></code>s in the decimal
degrees format. (To pass <span class="math notranslate nohighlight">\(DDDMMSS\)</span> “degrees minutes seconds” (DMS)
format values, convert them first with <a class="reference internal" href="#dms-dec"><span class="std std-ref">dms2dec</span></a> or
<a class="reference internal" href="#parselatitude-parselongitude">parselatitude, parselongitude</a>.). Negative numbers represent
south latitudes and west longitudes, i.e. these functions are
east-positive, and decimal format.</p>
<p>Valid values for latitude are -90 to 90 inclusive. Valid values for
longitude are -360 to 360 inclusive. A longitude value less than -180
will have 360 added to it, and a longitude value greater than 180 will
have 360 subtracted from it. This allows longitude values to continue to
increase or decrease when crossing the International Dateline, and thus
avoid a non-linear “step function”. Passing invalid <code class="docutils literal notranslate"><span class="pre">lat</span></code> or <code class="docutils literal notranslate"><span class="pre">lon</span></code>
values to <code class="docutils literal notranslate"><span class="pre">latlon2geocode</span></code> will return -1.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">lon</span></code> parameter is optional: both latitude and longitude (in that
order) may be given in a single space- or comma-separated text (<code class="docutils literal notranslate"><span class="pre">varchar</span></code>)
value for <code class="docutils literal notranslate"><span class="pre">lat</span></code>. Also, a <code class="docutils literal notranslate"><span class="pre">N</span></code>/<code class="docutils literal notranslate"><span class="pre">S</span></code> suffix (for latitude) or <code class="docutils literal notranslate"><span class="pre">E</span></code>/<code class="docutils literal notranslate"><span class="pre">W</span></code>
suffix (for longitude) may be given; <code class="docutils literal notranslate"><span class="pre">S</span></code> or <code class="docutils literal notranslate"><span class="pre">W</span></code> will negate the value.</p>
<p>The latitude and/or longitude may also have just about any of the formats
supported by <a class="reference internal" href="#parselatitude-parselongitude">parselatitude, parselongitude</a>, provided they are
disambiguated (e.g. separate parameters; or if one parameter, separated
by a comma and/or fully specified with degrees/minutes/seconds).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">--</span> <span class="n">Populate</span> <span class="n">a</span> <span class="n">table</span> <span class="k">with</span> <span class="n">latitude</span><span class="o">/</span><span class="n">longitude</span> <span class="n">information</span><span class="p">:</span>
<span class="n">create</span> <span class="n">table</span> <span class="n">geotest</span><span class="p">(</span><span class="n">city</span> <span class="n">varchar</span><span class="p">(</span><span class="mi">64</span><span class="p">),</span> <span class="n">lat</span> <span class="n">double</span><span class="p">,</span> <span class="n">lon</span> <span class="n">double</span><span class="p">,</span>
                     <span class="n">geocode</span> <span class="n">long</span><span class="p">);</span>
<span class="n">insert</span> <span class="n">into</span> <span class="n">geotest</span> <span class="n">values</span><span class="p">(</span><span class="s1">&#39;Cleveland, OH, USA&#39;</span><span class="p">,</span> <span class="mf">41.4</span><span class="p">,</span>  <span class="o">-</span><span class="mf">81.5</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">insert</span> <span class="n">into</span> <span class="n">geotest</span> <span class="n">values</span><span class="p">(</span><span class="s1">&#39;San Francisco, CA, USA&#39;</span><span class="p">,</span>   <span class="mf">37.78</span><span class="p">,</span> <span class="o">-</span><span class="mf">122.42</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">insert</span> <span class="n">into</span> <span class="n">geotest</span> <span class="n">values</span><span class="p">(</span><span class="s1">&#39;Davis, Ca, USA&#39;</span><span class="p">,</span>    <span class="mf">38.55</span><span class="p">,</span> <span class="o">-</span><span class="mf">121.74</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">insert</span> <span class="n">into</span> <span class="n">geotest</span> <span class="n">values</span><span class="p">(</span><span class="s1">&#39;New York, NY, USA&#39;</span><span class="p">,</span>  <span class="mf">40.81</span><span class="p">,</span> <span class="o">-</span><span class="mf">73.96</span><span class="p">,</span>  <span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="o">--</span> <span class="n">Prepare</span> <span class="k">for</span> <span class="n">geographic</span> <span class="n">searches</span><span class="p">:</span>
<span class="n">update</span> <span class="n">geotest</span> <span class="nb">set</span> <span class="n">geocode</span> <span class="o">=</span> <span class="n">latlon2geocode</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">);</span>
<span class="n">create</span> <span class="n">index</span> <span class="n">xgeotest_geocode</span> <span class="n">on</span> <span class="n">geotest</span><span class="p">(</span><span class="n">geocode</span><span class="p">);</span>
<span class="o">--</span> <span class="n">Search</span> <span class="k">for</span> <span class="n">cities</span> <span class="n">within</span> <span class="n">a</span> <span class="mi">3</span><span class="o">-</span><span class="n">degree</span><span class="o">-</span><span class="n">radius</span> <span class="s2">&quot;circle&quot;</span> <span class="p">(</span><span class="n">box</span><span class="p">)</span>
<span class="o">--</span> <span class="n">of</span> <span class="n">Cleveland</span><span class="p">,</span> <span class="n">nearest</span> <span class="n">first</span><span class="p">:</span>
<span class="n">select</span> <span class="n">city</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">distlatlon</span><span class="p">(</span><span class="mf">41.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">81.5</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span> <span class="n">MilesAway</span>
<span class="kn">from</span> <span class="nn">geotest</span>
<span class="n">where</span> <span class="n">geocode</span> <span class="n">between</span> <span class="p">(</span><span class="n">select</span> <span class="n">latlon2geocodearea</span><span class="p">(</span><span class="mf">41.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">81.5</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">))</span>
<span class="n">order</span> <span class="n">by</span> <span class="mi">4</span> <span class="n">asc</span><span class="p">;</span>
</pre></div>
</div>
<p>The geocode values returned by <code class="docutils literal notranslate"><span class="pre">latlon2geocode</span></code> and
<code class="docutils literal notranslate"><span class="pre">latlon2geocodearea</span></code> are platform-dependent in format and accuracy,
and should not be copied across platforms. On platforms with 32-bit
<code class="docutils literal notranslate"><span class="pre">long</span></code>s a geocode value is accurate to about 32 seconds (around half
a mile, depending on latitude). <code class="docutils literal notranslate"><span class="pre">-1</span></code> is returned for invalid input values.</p>
<p>See Also: <a class="reference internal" href="#geocode2lat-geocode2lon">geocode2lat, geocode2lon</a></p>
</div>
<div class="section" id="geocode2lat-geocode2lon">
<h2>geocode2lat, geocode2lon<a class="headerlink" href="#geocode2lat-geocode2lon" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">geocode2lat</span><span class="p">(</span><span class="n">geocode</span><span class="p">)</span>
<span class="n">geocode2lon</span><span class="p">(</span><span class="n">geocode</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">geocode2lat</span></code> and <code class="docutils literal notranslate"><span class="pre">geocode2lon</span></code> functions decode a geocode into
a latitude or longitude coordinate, respectively. The returned
coordinate is in the decimal degrees format. An invalid geocode value
(e.g. -1) will return NaN (Not a Number).</p>
<p>If you want <span class="math notranslate nohighlight">\(DDDMMSS\)</span> “degrees minutes seconds” (DMS) format, you
can use <a class="reference internal" href="#dms-dec"><span class="std std-ref">dec2dms</span></a> to convert it.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">select</span> <span class="n">city</span><span class="p">,</span> <span class="n">geocode2lat</span><span class="p">(</span><span class="n">geocode</span><span class="p">),</span> <span class="n">geocode2lon</span><span class="p">(</span><span class="n">geocode</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">geotest</span><span class="p">;</span>
</pre></div>
</div>
<p>As with <a class="reference internal" href="#latlon2x"><span class="std std-ref">latlon2geocode</span></a>, the <code class="docutils literal notranslate"><span class="pre">geocode</span></code> value is platform-dependent
in accuracy and format, so it should not be copied across platforms, and
the returned coordinates from <code class="docutils literal notranslate"><span class="pre">geocode2lat</span></code> and <code class="docutils literal notranslate"><span class="pre">geocode2lon</span></code> may
differ up to about half a minute from the original coordinates (due to
the finite resolution of a <code class="docutils literal notranslate"><span class="pre">long</span></code>). An invalid geocode value (e.g. -1)
will return <code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not a Number).</p>
<p>See Also: <a class="reference internal" href="#latlon2x"><span class="std std-ref">latlon2geocode</span></a></p>
</div>
<div class="section" id="parselatitude-parselongitude">
<h2>parselatitude, parselongitude<a class="headerlink" href="#parselatitude-parselongitude" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">parselatitude</span><span class="p">(</span><span class="n">latitudeText</span><span class="p">)</span>
<span class="n">parselongitude</span><span class="p">(</span><span class="n">longitudeText</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">parselatitude</span></code> and <code class="docutils literal notranslate"><span class="pre">parselongitude</span></code> functions parse a text
(<code class="docutils literal notranslate"><span class="pre">varchar</span></code>) latitude or longitude coordinate, respectively, and return
its value in decimal degrees as a <code class="docutils literal notranslate"><span class="pre">double</span></code>. The coordinate should be
in one of the following forms (optional parts in square brackets):</p>
<div class="line-block">
<div class="line">[<span class="math notranslate nohighlight">\(H\)</span>] <span class="math notranslate nohighlight">\(nnn\)</span> [<span class="math notranslate nohighlight">\(U\)</span>] [<code class="docutils literal notranslate"><span class="pre">:</span></code>] [<span class="math notranslate nohighlight">\(H\)</span>] [<span class="math notranslate nohighlight">\(nnn\)</span>
[<span class="math notranslate nohighlight">\(U\)</span>] [<code class="docutils literal notranslate"><span class="pre">:</span></code>] [<span class="math notranslate nohighlight">\(nnn\)</span> [<span class="math notranslate nohighlight">\(U\)</span>]]] [<span class="math notranslate nohighlight">\(H\)</span>]</div>
<div class="line"><span class="math notranslate nohighlight">\(DDMM\)</span>[<span class="math notranslate nohighlight">\(.MMM\)</span>…]</div>
<div class="line"><span class="math notranslate nohighlight">\(DDMMSS\)</span>[<span class="math notranslate nohighlight">\(.SSS\)</span>…]</div>
</div>
<p>where the terms are:</p>
<ul>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(nnn\)</span></div>
<div class="line">A number (integer or decimal) with optional plus/minus sign. Only
the first number may be negative, in which case it is a south
latitude or west longitude. Note that this is true even for
<span class="math notranslate nohighlight">\(DDDMMSS\)</span> (DMS) longitudes – i.e. the ISO 6709 east-positive
standard is followed, not the deprecated Texis/Vortex west-positive
standard.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(U\)</span></div>
<div class="line">A unit (case-insensitive):</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">d</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deg</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">deg.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">degrees</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'</span></code> (single quote) for minutes</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">m</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">min.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">minutes</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">&quot;</span></code> (double quote) for seconds</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">s</span></code> (iff <code class="docutils literal notranslate"><span class="pre">d</span></code>/<code class="docutils literal notranslate"><span class="pre">m</span></code> also used for degrees/minutes)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sec</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sec.</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">seconds</span></code></p></li>
<li><p>Unicode degree-sign (U+00B0), in ISO-8559-1 or UTF-8</p></li>
</ul>
<p>If no unit is given, the first number is assumed to be degrees, the
second minutes, the third seconds. Note that “<code class="docutils literal notranslate"><span class="pre">s</span></code>” may only be used
for seconds if “<code class="docutils literal notranslate"><span class="pre">d</span></code>” and/or “<code class="docutils literal notranslate"><span class="pre">m</span></code>” was also used for an earlier
degrees/minutes value; this is to help disambiguate “seconds” vs.
“southern hemisphere”.</p>
</li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(H\)</span></div>
<div class="line">A hemisphere (case-insensitive):</div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">N</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">north</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">S</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">south</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">E</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">east</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">W</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">west</span></code></p></li>
</ul>
<p>A longitude hemisphere may not be given for a latitude, and
vice-versa.</p>
</li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(DD\)</span></div>
<div class="line">A two- or three-digit degree value, with optional sign. Note that
longitudes are east-positive ala ISO 6709, not west-positive like
the deprecated Texis standard.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(MM\)</span></div>
<div class="line">A two-digit minutes value, with leading zero if needed to make two
digits.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(.MMM\)</span>…</div>
<div class="line">A zero or more digit fractional minute value.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(SS\)</span></div>
<div class="line">A two-digit seconds value, with leading zero if needed to make two
digits.</div>
</div>
</li>
<li><div class="line-block">
<div class="line"><span class="math notranslate nohighlight">\(.SSS\)</span>…</div>
<div class="line">A zero or more digit fractional seconds value.</div>
</div>
</li>
</ul>
<p>Whitespace is generally not required between terms in the first format.
A hemisphere token may only occur once. Degrees/minutes/seconds numbers
need not be in that order, if units are given after each number. If a
5-integer-digit <span class="math notranslate nohighlight">\(DDDMM\)</span>[<span class="math notranslate nohighlight">\(.MMM\)</span>…] format is given and the
degree value is out of range (e.g. more than 90 degrees latitude), it is
interpreted as a <span class="math notranslate nohighlight">\(DMMSS\)</span>[<span class="math notranslate nohighlight">\(.SSS\)</span>…] value instead. To
force <span class="math notranslate nohighlight">\(DDDMMSS\)</span>[<span class="math notranslate nohighlight">\(.SSS\)</span>…] for small numbers, pad with
leading zeros to 6 or 7 digits.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">insert</span> <span class="n">into</span> <span class="n">geotest</span><span class="p">(</span><span class="n">lat</span><span class="p">,</span> <span class="n">lon</span><span class="p">)</span>
  <span class="n">values</span><span class="p">(</span><span class="n">parselatitude</span><span class="p">(</span><span class="s1">&#39;54d 40m 10&quot;&#39;</span><span class="p">),</span>
         <span class="n">parselongitude</span><span class="p">(</span><span class="s1">&#39;W90 10.2&#39;</span><span class="p">));</span>
</pre></div>
</div>
<p>An invalid or unparseable latitude or longitude value will return
<code class="docutils literal notranslate"><span class="pre">NaN</span></code> (Not a Number). Extra unparsed/unparsable text may be allowed
(and ignored) after the coordinate in most instances. Out-of-range
values (e.g. latitudes greater than 90 degrees) are accepted; it is up
to the caller to bounds-check the result.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Moat Crossing Systems.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> and ❤️  using a custom <a href="https://github.com/LinxiFan/Sphinx-theme">theme</a> based on <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="../_static/language_data.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>